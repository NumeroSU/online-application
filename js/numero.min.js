function onLogin(){_user=$("#github_user").prop("value");_pwd=$("#github_pwd").prop("value");auth=btoa(_user+":"+_pwd);document.cookie="username="+_user;document.cookie="password="+_pwd;$.get({url:"https://api.github.com/users/"+_user+"/repos",headers:{Authorization:"Basic "+auth},success:getRepos})}function getRepos(a){$("#github_repositories").prop("disabled",!1);for(i=0;i<a.length;i++)$("#github_repositories").append("<option>"+a[i].name+"</option>");repo=a[0].name;getFiles(a[0].name)}
function getFiles(a){$.get({url:"https://api.github.com/repos/"+_user+"/"+a+"/contents",headers:{Authorization:"Basic "+auth},success:function(a){$("#github_files").prop("disabled",!1);for(i=0;i<a.length;i++)$("#github_files").append("<option>"+a[i].name+"</option>");file=a[0].name;getFileVersions(file)}})}
function getFileVersions(a){$.get({url:"https://api.github.com/repos/"+_user+"/"+repo+"/commits?path="+a,headers:{Authorization:"Basic "+auth},success:function(a){$("#button_load").prop("disabled",!1);$("#github_version").prop("disabled",!1);for(i=0;i<a.length;i++)$("#github_version").append("<option sha='"+a[i].commit.tree.sha+"'>"+a[i].commit.author.name+" - "+a[i].commit.message+"</option>");sha=a[0].commit.tree.sha;console.log(sha);getFileContent(file,sha)}})}
function getFileContent(a,b){$.get({url:"https://api.github.com/repos/"+_user+"/"+repo+"/git/trees/"+b,headers:{Authorization:"Basic "+auth},success:function(b){for(i=0;i<b.tree.length;i++)if(b.tree[i].path==a){var c=b.tree[i].sha;_file_sha=c;$.get({url:"https://api.github.com/repos/"+_user+"/"+repo+"/git/blobs/"+c,headers:{Authorization:"Basic "+auth},success:function(a){content=atob(a.content);$("#file_content").html(content)}})}}})};console.log(document.cookie);var _user=null,_pwd=null,auth=null,repo=null,file=null,sha=null,content=null,_file_sha=null,api_ip=$("#serverIP").prop("value");function getCookie(a){a+="=";for(var b=decodeURIComponent(document.cookie).split(";"),d=0;d<b.length;d++){for(var c=b[d];" "==c.charAt(0);)c=c.substring(1);if(0==c.indexOf(a))return c.substring(a.length,c.length)}return""}
""!=getCookie("username")&&""!=getCookie("password")&&(_user=getCookie("username"),_pwd=getCookie("password"),$("#github_user").prop("value",_user),$("#github_pwd").prop("value",_pwd),auth=btoa(_user+":"+_pwd),$.get({url:"https://api.github.com/users/"+_user+"/repos",headers:{Authorization:"Basic "+auth},success:getRepos}));var buttons=["#button_settings_3d","#button_settings_scene","#button_settings_help"],divs=["#settings_3d","#settings_scene","#settings_help"];$.each(buttons,function(a,b){$(b).click(function(){if(!$(this).hasClass("is-active")){$(this).addClass("is-active");for(j=0;j<buttons.length;j++)a!=j?$(buttons[j]).removeClass("is-active"):$(buttons[j]).addClass("is-active");$(divs[a]).show();for(j=0;j<divs.length;j++)a!=j&&$(divs[j]).hide()}})});
var modelsTabs=["#button_models_available","#button_models_loaded"],modelsMenus=["#modelslist","#modelsloaded"];$.each(modelsTabs,function(a,b){$(b).click(function(){if(!$(this).hasClass("is-active")){$(this).addClass("is-active");for(j=0;j<buttons.length;j++)a!=j?$(modelsTabs[j]).removeClass("is-active"):$(modelsTabs[j]).addClass("is-active");$(modelsMenus[a]).show();for(j=0;j<divs.length;j++)a!=j&&$(modelsMenus[j]).hide()}})});
function query_available_models(a){$.get("https://"+a+"/models",function(a){for(i=0;i<a.data.length;i++){var b='<a id="'+a.data[i].split(".")[0]+'" class="model_button panel-block"><span class="panel-icon"><i class="fas fa-cube" aria-hidden="true"></i></span>';$("#modelslist").append(b+a.data[i]+"</a>")}})}query_available_models(api_ip);$("#login").click(onLogin);$("#github_repositories").change(function(){$("#github_files").html("");repo=$(this).prop("value");$("#github_files").html("");getFiles(repo)});$("#github_files").change(function(){file=$(this).prop("value");$("#github_version").html("");getFileVersions($(this).prop("value"))});$("#github_version").change(function(){sha=$("option:selected",this).attr("sha");$("#file_content").html("");getFileContent(file,sha);console.log(_file_sha)});
$("#button_save_modal").click(function(){$("#make_commit_field").show();$("#load_commit_field").hide();$("#button_load").hide();$("#button_save").show();$("#modal_title").html("Save reconstruction");$(".modal").addClass("is-active")});$("#button_load_modal").click(function(){$("#make_commit_field").hide();$("#load_commit_field").show();$("#button_save").hide();$("#button_load").show();$("#modal_title").html("Load reconstruction");$(".modal").addClass("is-active")});
$("#button_save").click(function(){$("#button_save").addClass("is-loading");$("#savemodal").addClass("is-active");sets={user:_user,pwd:_pwd,repo:repo,file:file,sha:_file_sha};var a=$("#commit_message").prop("value");b4w.require("numero_main").save_state(a,sets);getFileVersions(file)});$("#button_load").click(function(){$("#button_save").prop("disabled",!1);$("#button_delete").prop("disabled",!1);$(this).addClass("is-loading");sets={user:_user,pwd:_pwd,repo:repo,file:file,sha:_file_sha};b4w.require("numero_main").load_state(sets)});
$(".modal-close").click(function(){$(".modal").removeClass("is-active")});$(".delete").click(function(){$(".modal").removeClass("is-active")});$("#button_cancel").click(function(){$(".modal").removeClass("is-active")});$("#serverIP").change(function(){api_ip=$(this).prop("value");query_available_models(api_ip)});
