b4w.register("numero_main",function(y,f){function L(b,a){a?(C.create_preloader(),b.oncontextmenu=function(b){b.preventDefault();b.stopPropagation();return!1},b.addEventListener("mousedown",D),b.addEventListener("touchstart",D),b.addEventListener("mouseup",E),b.addEventListener("touchend",E),b.addEventListener("mousemove",F),b.addEventListener("touchmove",F),window.onresize=G.resize_to_container,G.resize_to_container(),M.load(N+"numero.json",O,P)):console.log("b4w init failure")}function D(b){b.preventDefault&&
b.preventDefault();c=g.pick_object(b.offsetX,b.offsetY);console.log(c);if(2==b.button){if(null!=c){var a=g.get_object_name(c);if(b.ctrlKey)h.includes(c)?($("#"+a).find("input").prop("checked",!1),b=h.indexOf(c),-1!=b&&h.splice(b,1),g.set_outline_intensity(c,0)):($("#"+a).find("input").prop("checked",!0),h.push(c),g.set_outline_intensity(c,1));else{$("#"+a).siblings().find("input").prop("checked",!1);for(b=0;b<h.length;b++)g.set_outline_intensity(h[b],0);h.includes(c)?1<h.length?($("#"+a).find("input").prop("checked",
!0),h=[c],g.set_outline_intensity(c,1)):($("#"+a).find("input").prop("checked",!1),h=[]):($("#"+a).find("input").prop("checked",!0),h=[c],g.set_outline_intensity(c,1))}}}else null!=c&&h.includes(c)?0<h.length&&(w.disable_camera_controls(),a=g.get_active_camera(),b.ctrlKey?(z=!0,b=x.calc_ray(a,b.offsetX,b.offsetY,l),b=k.get_pline_directional_vec(b,t),a=m.get_translation(a,A),k.set_pline_initial_point(l,a),k.set_pline_directional_vec(l,b),a=k.line_plane_intersect(B,-1.1,l,n),n=m.get_translation(c),
p.subtract(a,n,u),console.log(a,n,u)):(v=!0,m.get_translation(c,t),x.project_point(a,t,q),q[0]=b.offsetX-q[0],q[1]=b.offsetY-q[1])):v=!1}function E(b){z=v=!1;w.enable_camera_controls();c=null}function F(b){if(v){var a=g.get_active_camera(),e=b.offsetX,d=b.offsetY;if(0<=e&&0<=d)for(e-=q[0],d-=q[1],e=x.calc_ray(a,e,d,l),e=k.get_pline_directional_vec(e,t),a=m.get_translation(a,A),k.set_pline_initial_point(l,a),k.set_pline_directional_vec(l,e),a=k.line_plane_intersect(B,-1.1,l,n),e=new Float32Array(3),
p.subtract(a,m.get_translation(c),e),console.log(e),i=0;i<h.length;i++)a=new Float32Array(3),p.add(m.get_translation(h[i]),e,a),m.set_translation_v(h[i],a)}if(z){a=g.get_active_camera();e=x.calc_ray(a,b.offsetX,b.offsetY,l);e=k.get_pline_directional_vec(e,t);a=m.get_translation(a,A);k.set_pline_initial_point(l,a);k.set_pline_directional_vec(l,e);a=k.line_plane_intersect(B,-1.1,l,n);b=new Float32Array(3);n=m.get_translation(c);p.subtract(a,n,b);a=p.angle(b,u);e=new Float32Array(3);p.subtract(b,u,e);
var d=p.dot(e,[0,0,1]),f=new Float32Array(3);p.cross(e,[0,0,1],f);m.rotate_z_local(c,Math.sign(f[0])*a);u=b;console.log(a,d,f)}}function P(b){C.update_preloader(b)}function O(b,a){if(a){w.enable_camera_controls();var e=g.get_object_by_name("cube");g.hide_object(e);$(".model_button").click(function(){var b=$(this).attr("id"),a=$(this);$.get("https://134.157.66.221:5003/models/"+b,function(c){g.get_all_objects("MESH");var d=H.copy(e,b,!0),f=new Uint32Array(c.data.ibo);c=new Float32Array(c.data.vbo);
I.override_geometry(d,"logo",f,c,!1);g.append_object(d);J.set_translation(d,0,0,1.1);g.show_object(d);g.update_scene_materials_params();a.remove();f='<label id="'+b+'" class="panel-block"><input type="checkbox">';$("#modelsloaded").append(f+b+"</input></label>");$("#"+b).find("input").bind("change",function(){var a=$(this).prop("checked");d=g.get_object_by_name(b);1==a?(h.push(d),g.set_outline_intensity(d,1)):(a=h.indexOf(d),-1!=a&&h.splice(a,1),g.set_outline_intensity(d,0));console.log(h)})})})}else console.log("b4w load failure")}
var w=f("app"),Q=f("config"),M=f("data"),C=f("preloader"),R=f("version"),I=f("geometry"),g=f("scenes"),H=f("objects"),J=f("transform"),G=f("container");f("input");f("mouse");var m=f("transform"),x=f("camera"),k=f("math"),p=f("vec3");f("quat");var h=[],v=!1,z=!1,q=new Float32Array(2),l=k.create_pline(),t=new Float32Array(3),A=new Float32Array(3),n=new Float32Array(3),u=new Float32Array(3),B=[0,0,1],c=null,K="DEBUG"==R.type(),N=Q.get_assets_path("numero");y.init=function(){w.init({canvas_container_id:"main_canvas_container",
callback:L,show_fps:K,console_verbose:K,autoresize:!0})};y.save_state=function(b,a){for(var e=a.user,d=a.pwd,c=a.repo,f=a.file,h=a.sha,k="",l=g.get_all_objects("MESH"),r=0;r<l.length;r++)if("cube"!=l[r].name&&"Plane"!=l[r].name)var S=m.get_matrix(l[r]),k=k+(l[r].name+","+S.toString()+"\n");$.get("https://api.github.com/repos/"+e+"/"+c+"/contents/"+f,function(a){h=a.sha;a={path:f,message:b,content:btoa(k),sha:h};$.ajax({url:"https://api.github.com/repos/"+e+"/"+c+"/contents/"+f,data:JSON.stringify(a),
contentType:"application/json",type:"PUT",beforeSend:function(a){a.setRequestHeader("Authorization","Basic "+btoa(e+":"+d))},success:function(a){$("#button_save").removeClass("is-loading");$(".modal").removeClass("is-active")},error:function(a,b,d){console.log(" I did not did it:",a,b,d)}})})};y.load_state=function(b){for(var a=g.get_all_objects("MESH"),e=[],d=0;d<a.length;d++)"cube"!=a[d].name&&"Plane"!=a[d].name&&e.push(a[d]);for(d=0;d<e.length;d++)g.get_object_data_id(e[d]),g.remove_object(e[d]);
$.ajax({url:"https://api.github.com/repos/"+b.user+"/"+b.repo+"/git/blobs/"+b.sha,success:function(a){a=atob(a.content).split("\n");var b=[],e=[];for(d=0;d<a.length;d++){var c=a[d].split(",");if(2<c.length){b.push(c[0]);for(var f=new Float32Array(16),l=0;16>l;l++)f[l]=parseFloat(c[l+1]);e.push(f)}}for(var k=0;k<b.length;k++)$.ajax({url:"https://134.157.66.221:5003/models/"+b[k],success:function(a){var c=g.get_object_by_name("cube"),c=H.copy(c,b[k],!0),d=new Uint32Array(a.data.ibo);a=new Float32Array(a.data.vbo);
I.override_geometry(c,"logo",d,a,!1);g.append_object(c);J.set_matrix(c,e[k]);g.show_object(c);g.update_scene_materials_params();$(".model_button").each(function(){$(this).attr("id")==b[k]&&$(this).remove()});a='<label id="'+b[k]+'" class="panel-block"><input type="checkbox">';$("#modelsloaded").append(a+b[k]+"</input></label>");$("#"+b[k]).find("input").bind("change",function(){var a=$(this).parent().attr("id");console.log(a);var b=$(this).prop("checked"),a=g.get_object_by_name(a);1==b?(h.push(a),
g.set_outline_intensity(a,1)):(b=h.indexOf(a),-1!=b&&h.splice(b,1),g.set_outline_intensity(a,0));console.log(h)})},async:!1});$("#button_load").removeClass("is-loading");$(".modal").removeClass("is-active")}})}});b4w.require("numero_main").init();
